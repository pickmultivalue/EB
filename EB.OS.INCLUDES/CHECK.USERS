!
  EXECUTE 'WHERE' CAPTURING OUTPUT
  NBR.ACTIVE=DCOUNT(OUTPUT,AM)
  ACTIVE.PORTS=''
  LINE1=2
  LOOP
    LINE=FIELD(TRIM(OUTPUT<LINE1>),' ',1)
    PORT=OCONV(LINE,'MCN')
  UNTIL LINE='' OR PORT#'' DO LINE1+=1 REPEAT
  CNT=1
  FOR I=LINE1 TO NBR.ACTIVE
    LINE=OUTPUT<I>
    IF LINE[1,10]#'' THEN
      LINE=TRIM(LINE)
      ACTIVE.PORTS<1,CNT>=OCONV(FIELD(LINE,' ',1),'MCN')+0
    END
    CNT+=1
  NEXT I
