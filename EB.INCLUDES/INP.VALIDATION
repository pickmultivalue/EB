* @(#) INP.VALIDATION Ported to jBASE 15:13:20  17 APR 2000
    IF FG$SCR.RETURN<1,FG$FLD> THEN
USER.SUB.CALL:      !
        CALL @FG$SCR.VALIDATE
        IF NOT(FG$VALID) THEN
            FG$FIELD=FG$OLD.FIELD
            IF FG$PAGING THEN WIN.PANE(FG$FLD)=FG$FIELD ELSE DAT(FG$FLD)=FG$FIELD
            GOTO RE.ENTER.FIELD
        END
        IF FG$RECALC#'' THEN CALL EB.RECALC(FULL.REFRESH)
        IF FG$ERROR.NBR THEN CALL EB.PRINT.ERR(FG$ERROR.MSGS<FG$ERROR.NBR>,'','',1,'',''); FG$ERROR.NBR=FALSE
!
!!!! w a t c h   p o i n t
!
        IF FG$FINISHED THEN GOTO FINISH
!
        IF FG$SUB.SCREEN#'' AND FG$SUB.SCREEN#FG$SCR.PAGE.SUB<1,FG$FLD,1> THEN
            FG$PROG.CALL<2>=2;GOSUB CALL.SUB
            IF FG$SCREEN.RETURN=TRUE THEN GOTO USER.SUB.CALL
        END
        STMP=FG$DISPLAY.LIST
        IF FG$ACT.CODE THEN
            INCLUDE EB.INCLUDES ON.INP
            IF FG$PROCESSING.FIELD THEN
                IF FG$PROCESSING.FIELD=1 THEN FG$FIELD=FG$OLD.FIELD; GOTO RE.ENTER.FIELD
                IF FG$PROCESSING.FIELD=3 THEN GOTO ENTER.FIELD
            END ELSE GOTO END.OF.INPUT
        END
        IF FG$REFRESH AND NOT(FG$VALID) THEN CALL EB.REFRESH
        IF FG$DISPLAY.LIST#'' THEN
            IF STMP#FG$DISPLAY.LIST THEN FG$CHANGES=TRUE
            TOTAL.LIST=FG$DISPLAY.LIST  ;! save for TOTALs
        END
    END
